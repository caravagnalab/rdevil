roc_curve
devil.results
View(devil.results)
setwd("~/Desktop/dottorato/biPOD_paper/sauer_brenton/scripts/")
rm(list = ls())
source("report.R")
library(biPOD)
library(tidyverse)
library(ggplot2)
# Load data
patient_id <- 831
data <- read.csv("../data/sauer_brenton_parsed.csv", sep=",") %>% filter(OV04_patient == patient_id)
data_plot <- data %>%
rename(count = TumourVolume) %>%
mutate(time = time / 14) %>%
filter(count > 0) %>%
mutate(mouse = factor(mouse)) %>%
ggplot(mapping = aes(x=time, y=count, color=Treatment_group., fill=Treatment_group., group=mouse, shape=mouse)) +
geom_point() +
geom_line() +
scale_fill_manual(values = c("#af8dc3", "#7fbf7b")) +
scale_color_manual(values = c("#af8dc3", "#7fbf7b")) +
scale_shape_manual(values = c(1:19)) +
biPOD:::my_ggplot_theme(cex_opt = 1.2)
setwd("~/Desktop/dottorato/biPOD_paper/sauer_brenton/scripts/")
rm(list = ls())
source("report.R")
library(biPOD)
library(tidyverse)
library(ggplot2)
setwd("~/Desktop/dottorato/biPOD_paper/sauer_brenton/scripts/")
rm(list = ls())
library(biPOD)
library(tidyverse)
library(ggplot2)
# CONSTANTS
CEX_OPT <- 1.2
treatment_color <- "maroon"
control_color <- "darkgray"
vline_color <- "black"
# DATA
patient_id <- 828
data <- read.csv("../data/sauer_brenton_parsed.csv", sep=",") %>% filter(OV04_patient == patient_id)
mouse_ids <- data %>% pull(mouse) %>% unique()
fits <- list()
for (m in mouse_ids) {
f <- readRDS(paste0("../results/fits_", m, ".rds"))
fits[[m]] <- f
}
parameters <- dplyr::tibble()
for (m in mouse_ids) {
x <- fits[[m]]
if (!(is.null(x$metadata$breakpoints))) {
d <- x$breakpoints_fit$draws(c("changing_times[1]", "changing_times[2]"), format = "matrix") %>%
as_tibble()
d[,1:2] <- sapply(d[,1:2], as.numeric)
d <- d %>% mutate(mouse = m)
parameters <- bind_rows(parameters, d)
}
}
# Plot with inferred stuff
median_inferred_changepoints <- parameters %>%
group_by(mouse) %>%
summarise_all(median) %>%
summarise_all(median)
data_plot <- data %>%
rename(count = TumourVolume) %>%
mutate(time = time / 14) %>%
filter(count > 0) %>%
mutate(mouse = factor(mouse))
data
data_plot <- data %>%
dplye::rename(count = TumourVolume) %>%
mutate(time = time / 14) %>%
filter(count > 0) %>%
mutate(mouse = factor(mouse))
data_plot <- data %>%
dplyr::rename(count = TumourVolume) %>%
dplyr::mutate(time = time / 14) %>%
filter(count > 0) %>%
mutate(mouse = factor(mouse))
data_plot <- data %>%
dplyr::rename(count = TumourVolume) %>%
dplyr::mutate(time = time / 14) %>%
dplyr::filter(count > 0) %>%
dplyr::mutate(mouse = factor(mouse))
ggplot(data = data_plot, mapping = aes(x=time, y=count, color=Treatment_group., group=mouse, shape=mouse)) +
geom_point() +
geom_line() +
facet_grid(~ Treatment_group.) +
geom_vline(data = data_plot %>% filter(Treatment_group. != "Control"),
mapping = aes(xintercept = median_inferred_changepoints$`changing_times[1]`, col = "Median inferred changpoints")) +
geom_vline(data = data_plot %>% filter(Treatment_group. != "Control"),
mapping = aes(xintercept = median_inferred_changepoints$`changing_times[2]`, col = "Median inferred changpoints")) +
scale_color_manual(values = c(control_color, vline_color, treatment_color)) +
scale_shape_manual(values = c(1:19)) +
labs(shape = "", color = "") +
biPOD:::my_ggplot_theme(cex_opt = CEX_OPT)
data <- read.csv("../data/sauer_brenton_parsed.csv", sep=",") %>% filter(OV04_patient == patient_id)
data
# DATA
patient_id <- 828
data <- read.csv("../data/sauer_brenton_parsed.csv", sep=",") %>% filter(OV04_patient == patient_id) %>%
filter(!((mouse == 541) & (time == 6)))
data
read.csv("../data/sauer_brenton_parsed.csv", sep=",") %>% filter(OV04_patient == patient_id)
data %>%
dplyr::rename(count = TumourVolume) %>%
dplyr::mutate(time = time / 14) %>%
dplyr::filter(count > 0) %>%
dplyr::mutate(mouse = factor(mouse))
data %>%
dplyr::rename(count = TumourVolume) %>%
dplyr::mutate(time = time / 14) %>%
dplyr::filter(count > 0) %>%
dplyr::mutate(mouse = factor(mouse)) %>%
dplyr::filter(!((mouse == 541) & (time == 6)))
data_plot %>% filter(mouse == 530)
data %>%
dplyr::rename(count = TumourVolume) %>%
dplyr::mutate(time = time / 14) %>%
dplyr::filter(count > 0) %>%
dplyr::mutate(mouse = factor(mouse)) %>%
dplyr::filter(!((mouse == 541) & (time == 6))) %>%
dplyr::filter(!((mouse == 530) & (count >= 500)))
data %>%
dplyr::rename(count = TumourVolume) %>%
dplyr::mutate(time = time / 14) %>%
dplyr::filter(count > 0) %>%
dplyr::mutate(mouse = factor(mouse)) %>%
dplyr::filter(!((mouse == 541) & (time == 6)))
data %>%
dplyr::rename(count = TumourVolume) %>%
dplyr::mutate(time = time / 14) %>%
dplyr::filter(count > 0) %>%
dplyr::mutate(mouse = factor(mouse)) %>%
dplyr::filter(!((mouse == 541) & (time == 6))) %>%
dplyr::filter(!((mouse == 530) & (count >= 500)))
View(data)
data %>%
dplyr::rename(count = TumourVolume) %>%
dplyr::mutate(time = time / 14) %>%
dplyr::filter(count > 0) %>%
dplyr::mutate(mouse = factor(mouse)) %>%
dplyr::filter(!((mouse == 541) & (time == 6))) %>%
dplyr::filter(!((mouse == 530) && (count >= 500)))
data %>%
dplyr::rename(count = TumourVolume) %>%
dplyr::mutate(time = time / 14) %>%
dplyr::filter(count > 0) %>%
dplyr::mutate(mouse = factor(mouse)) %>%
dplyr::filter(!((mouse == 541) & (time == 6))) %>%
dplyr::filter(!((mouse == 530) & (count >= 500)))
data %>%
dplyr::rename(count = TumourVolume) %>%
dplyr::mutate(time = time / 14) %>%
dplyr::filter(count > 0) %>%
dplyr::mutate(round_count = round(count)) %>%
dplyr::mutate(mouse = factor(mouse)) %>%
dplyr::filter(!((mouse == 541) & (time == 6))) %>%
dplyr::filter(!((mouse == 530) & (count == 500)))
data %>%
dplyr::rename(count = TumourVolume) %>%
dplyr::mutate(time = time / 14) %>%
dplyr::filter(count > 0) %>%
dplyr::mutate(round_count = round(count)) %>%
dplyr::mutate(mouse = factor(mouse)) %>%
dplyr::filter(!((mouse == 541) & (time == 6)))
data %>%
dplyr::rename(count = TumourVolume) %>%
dplyr::mutate(time = time / 14) %>%
dplyr::filter(count > 0) %>%
dplyr::mutate(round_count = round(count)) %>%
dplyr::mutate(mouse = factor(mouse)) %>%
dplyr::filter(!((mouse == 541) & (time == 6))) %>%
dplyr::filter(!((mouse == 530) & (count == 500)))
data_plot <- data %>%
dplyr::rename(count = TumourVolume) %>%
dplyr::mutate(time = time / 14) %>%
dplyr::filter(count > 0) %>%
dplyr::mutate(round_count = round(count)) %>%
dplyr::mutate(mouse = factor(mouse))
View(data_plot)
data_plot <- data %>%
dplyr::rename(count = TumourVolume) %>%
dplyr::mutate(time = time / 14) %>%
dplyr::filter(count > 0) %>%
dplyr::mutate(round_count = round(count)) %>%
dplyr::mutate(mouse = factor(mouse)) %>%
dplyr::filter(!((mouse == 541) & (time == 6))) %>%
dplyr::filter(!((mouse == 530) & (round_count == 500)))
View(data_plot)
data_plot <- data %>%
dplyr::rename(count = TumourVolume) %>%
dplyr::mutate(time = time / 14) %>%
dplyr::filter(count > 0) %>%
dplyr::mutate(round_count = round(count)) %>%
dplyr::mutate(mouse = factor(mouse)) %>%
dplyr::filter(!((mouse == 541) & (time == 6))) %>%
dplyr::filter(!((mouse == 530) & (round_count == 1688)))
ggplot(data = data_plot, mapping = aes(x=time, y=count, color=Treatment_group., group=mouse, shape=mouse)) +
geom_point() +
geom_line() +
facet_grid(~ Treatment_group.) +
geom_vline(data = data_plot %>% filter(Treatment_group. != "Control"),
mapping = aes(xintercept = median_inferred_changepoints$`changing_times[1]`, col = "Median inferred changpoints")) +
geom_vline(data = data_plot %>% filter(Treatment_group. != "Control"),
mapping = aes(xintercept = median_inferred_changepoints$`changing_times[2]`, col = "Median inferred changpoints")) +
scale_color_manual(values = c(control_color, vline_color, treatment_color)) +
scale_shape_manual(values = c(1:19)) +
labs(shape = "", color = "") +
biPOD:::my_ggplot_theme(cex_opt = CEX_OPT)
# CONSTANTS
CEX_OPT <- 1.2
treatment_color <- "maroon"
control_color <- "darkgray"
vline_color <- "#333333"
# DATA
patient_id <- 828
data <- read.csv("../data/sauer_brenton_parsed.csv", sep=",") %>% filter(OV04_patient == patient_id)
mouse_ids <- data %>% pull(mouse) %>% unique()
fits <- list()
for (m in mouse_ids) {
f <- readRDS(paste0("../results/fits_", m, ".rds"))
fits[[m]] <- f
}
parameters <- dplyr::tibble()
for (m in mouse_ids) {
x <- fits[[m]]
if (!(is.null(x$metadata$breakpoints))) {
d <- x$breakpoints_fit$draws(c("changing_times[1]", "changing_times[2]"), format = "matrix") %>%
as_tibble()
d[,1:2] <- sapply(d[,1:2], as.numeric)
d <- d %>% mutate(mouse = m)
parameters <- bind_rows(parameters, d)
}
}
# Plot with inferred stuff
median_inferred_changepoints <- parameters %>%
group_by(mouse) %>%
summarise_all(median) %>%
summarise_all(median)
data_plot <- data %>%
dplyr::rename(count = TumourVolume) %>%
dplyr::mutate(time = time / 14) %>%
dplyr::filter(count > 0) %>%
dplyr::mutate(round_count = round(count)) %>%
dplyr::mutate(mouse = factor(mouse)) %>%
dplyr::filter(!((mouse == 541) & (time == 6))) %>%
dplyr::filter(!((mouse == 530) & (round_count == 1688)))
ggplot(data = data_plot, mapping = aes(x=time, y=count, color=Treatment_group., group=mouse, shape=mouse)) +
geom_point() +
geom_line() +
facet_grid(~ Treatment_group.) +
geom_vline(data = data_plot %>% filter(Treatment_group. != "Control"),
mapping = aes(xintercept = median_inferred_changepoints$`changing_times[1]`, col = "Median inferred changpoints")) +
geom_vline(data = data_plot %>% filter(Treatment_group. != "Control"),
mapping = aes(xintercept = median_inferred_changepoints$`changing_times[2]`, col = "Median inferred changpoints")) +
scale_color_manual(values = c(control_color, vline_color, treatment_color)) +
scale_shape_manual(values = c(1:19)) +
labs(shape = "", color = "") +
biPOD:::my_ggplot_theme(cex_opt = CEX_OPT)
ggplot(data = data_plot, mapping = aes(x=time, y=count, color=Treatment_group., group=mouse, shape=mouse)) +
geom_point() +
geom_line(show.legend = F) +
facet_grid(~ Treatment_group.) +
geom_vline(data = data_plot %>% filter(Treatment_group. != "Control"),
mapping = aes(xintercept = median_inferred_changepoints$`changing_times[1]`, col = "Median inferred changpoints")) +
geom_vline(data = data_plot %>% filter(Treatment_group. != "Control"),
mapping = aes(xintercept = median_inferred_changepoints$`changing_times[2]`, col = "Median inferred changpoints")) +
scale_color_manual(values = c(control_color, vline_color, treatment_color)) +
scale_shape_manual(values = c(1:19)) +
labs(shape = "", color = "") +
biPOD:::my_ggplot_theme(cex_opt = CEX_OPT)
ggplot(data = data_plot, mapping = aes(x=time, y=count, color=Treatment_group., group=mouse, shape=mouse)) +
geom_point() +
geom_line(show.legend = F) +
facet_grid(~ Treatment_group.) +
geom_vline(data = data_plot %>% filter(Treatment_group. != "Control"),
mapping = aes(xintercept = median_inferred_changepoints$`changing_times[1]`, col = "Median inferred changpoints")) +
geom_vline(data = data_plot %>% filter(Treatment_group. != "Control"),
mapping = aes(xintercept = median_inferred_changepoints$`changing_times[2]`, col = "Median inferred changpoints")) +
#scale_color_manual(values = c(control_color, vline_color, treatment_color)) +
scale_shape_manual(values = c(1:19)) +
labs(shape = "", color = "") +
biPOD:::my_ggplot_theme(cex_opt = CEX_OPT)
ggplot(data = data_plot, mapping = aes(x=time, y=count, color=Treatment_group., group=mouse, shape=mouse)) +
geom_point() +
geom_line() +
facet_grid(~ Treatment_group.) +
geom_vline(data = data_plot %>% filter(Treatment_group. != "Control"),
mapping = aes(xintercept = median_inferred_changepoints$`changing_times[1]`, col = "Median inferred changpoints")) +
geom_vline(data = data_plot %>% filter(Treatment_group. != "Control"),
mapping = aes(xintercept = median_inferred_changepoints$`changing_times[2]`, col = "Median inferred changpoints")) +
scale_color_manual(values = c(control_color, vline_color, treatment_color)) +
scale_shape_manual(values = c(1:19)) +
labs(shape = "", color = "") +
biPOD:::my_ggplot_theme(cex_opt = CEX_OPT)
ggplot(data = data_plot, mapping = aes(x=time, y=count, color=Treatment_group., group=mouse, shape=mouse)) +
geom_point() +
geom_line() +
facet_grid(~ Treatment_group.) +
geom_vline(data = data_plot %>% filter(Treatment_group. != "Control"),
mapping = aes(xintercept = median_inferred_changepoints$`changing_times[1]`, col = "Median inferred changpoints")) +
geom_vline(data = data_plot %>% filter(Treatment_group. != "Control"),
mapping = aes(xintercept = median_inferred_changepoints$`changing_times[2]`, col = "Median inferred changpoints")) +
scale_color_manual(values = c(NA, vline_color, treatment_color)) +
scale_shape_manual(values = c(1:19)) +
labs(shape = "", color = "") +
biPOD:::my_ggplot_theme(cex_opt = CEX_OPT)
ggplot(data = data_plot, mapping = aes(x=time, y=count, color=Treatment_group., group=mouse, shape=mouse)) +
geom_point() +
geom_line() +
facet_grid(~ Treatment_group.) +
geom_vline(data = data_plot %>% filter(Treatment_group. != "Control"),
mapping = aes(xintercept = median_inferred_changepoints$`changing_times[1]`, fill = "Median inferred changpoints")) +
geom_vline(data = data_plot %>% filter(Treatment_group. != "Control"),
mapping = aes(xintercept = median_inferred_changepoints$`changing_times[2]`, fill = "Median inferred changpoints")) +
scale_color_manual(values = c(control_color, vline_color, treatment_color)) +
scale_shape_manual(values = c(1:19)) +
labs(shape = "", color = "") +
biPOD:::my_ggplot_theme(cex_opt = CEX_OPT)
ggplot(data = data_plot, mapping = aes(x=time, y=count, color=Treatment_group., group=mouse, shape=mouse)) +
geom_point() +
geom_line() +
facet_grid(~ Treatment_group.) +
geom_vline(data = data_plot %>% filter(Treatment_group. != "Control"),
mapping = aes(xintercept = median_inferred_changepoints$`changing_times[1]`, fill = "Median inferred changpoints")) +
geom_vline(data = data_plot %>% filter(Treatment_group. != "Control"),
mapping = aes(xintercept = median_inferred_changepoints$`changing_times[2]`, fill = "Median inferred changpoints")) +
scale_color_manual(values = c(control_color, vline_color, treatment_color)) +
scale_fill_manual(values = c(vline_color)) +
scale_shape_manual(values = c(1:19)) +
labs(shape = "", color = "") +
biPOD:::my_ggplot_theme(cex_opt = CEX_OPT)
ggplot(data = data_plot, mapping = aes(x=time, y=count, color=Treatment_group., group=mouse, shape=mouse)) +
geom_point() +
geom_line() +
facet_grid(~ Treatment_group.) +
geom_vline(data = data_plot %>% filter(Treatment_group. != "Control"),
mapping = aes(xintercept = median_inferred_changepoints$`changing_times[1]`, col = "Median inferred changpoints")) +
geom_vline(data = data_plot %>% filter(Treatment_group. != "Control"),
mapping = aes(xintercept = median_inferred_changepoints$`changing_times[2]`, col = "Median inferred changpoints")) +
scale_color_manual(values = c(control_color, vline_color, treatment_color)) +
scale_fill_manual(values = c(vline_color)) +
scale_shape_manual(values = c(1:19)) +
labs(shape = "", color = "") +
theme(strip.background = element_blank(),
strip.text.y = element_blank()) +
biPOD:::my_ggplot_theme(cex_opt = CEX_OPT)
ggplot(data = data_plot, mapping = aes(x=time, y=count, color=Treatment_group., group=mouse, shape=mouse)) +
geom_point() +
geom_line() +
facet_grid(~ Treatment_group.) +
geom_vline(data = data_plot %>% filter(Treatment_group. != "Control"),
mapping = aes(xintercept = median_inferred_changepoints$`changing_times[1]`, col = "Median inferred changpoints")) +
geom_vline(data = data_plot %>% filter(Treatment_group. != "Control"),
mapping = aes(xintercept = median_inferred_changepoints$`changing_times[2]`, col = "Median inferred changpoints")) +
scale_color_manual(values = c(control_color, vline_color, treatment_color)) +
scale_fill_manual(values = c(vline_color)) +
scale_shape_manual(values = c(1:19)) +
labs(shape = "", color = "") +
biPOD:::my_ggplot_theme(cex_opt = CEX_OPT) +
theme(strip.background = element_blank(),
strip.text.y = element_blank())
ggplot(data = data_plot, mapping = aes(x=time, y=count, color=Treatment_group., group=mouse, shape=mouse)) +
geom_point() +
geom_line() +
facet_grid(. ~ Treatment_group.) +
geom_vline(data = data_plot %>% filter(Treatment_group. != "Control"),
mapping = aes(xintercept = median_inferred_changepoints$`changing_times[1]`, col = "Median inferred changpoints")) +
geom_vline(data = data_plot %>% filter(Treatment_group. != "Control"),
mapping = aes(xintercept = median_inferred_changepoints$`changing_times[2]`, col = "Median inferred changpoints")) +
scale_color_manual(values = c(control_color, vline_color, treatment_color)) +
scale_fill_manual(values = c(vline_color)) +
scale_shape_manual(values = c(1:19)) +
labs(shape = "", color = "") +
biPOD:::my_ggplot_theme(cex_opt = CEX_OPT) +
theme(strip.background = element_blank(),
strip.text.y = element_blank())
ggplot(data = data_plot, mapping = aes(x=time, y=count, color=Treatment_group., group=mouse, shape=mouse)) +
geom_point() +
geom_line() +
facet_grid(. ~ Treatment_group.) +
geom_vline(data = data_plot %>% filter(Treatment_group. != "Control"),
mapping = aes(xintercept = median_inferred_changepoints$`changing_times[1]`, col = "Median inferred changpoints")) +
geom_vline(data = data_plot %>% filter(Treatment_group. != "Control"),
mapping = aes(xintercept = median_inferred_changepoints$`changing_times[2]`, col = "Median inferred changpoints")) +
scale_color_manual(values = c(control_color, vline_color, treatment_color)) +
scale_fill_manual(values = c(vline_color)) +
scale_shape_manual(values = c(1:19)) +
labs(shape = "", color = "") +
biPOD:::my_ggplot_theme(cex_opt = CEX_OPT) +
theme(strip.background = element_blank(),
strip.text.y = element_blank(),
strip.text.x = element_blank()
)
# CONSTANTS
CEX_OPT <- 1.2
treatment_color <- "#af8dc3"
control_color <- "darkgray"
vline_color <- "#333333"
# DATA
patient_id <- 828
data <- read.csv("../data/sauer_brenton_parsed.csv", sep=",") %>% filter(OV04_patient == patient_id)
mouse_ids <- data %>% pull(mouse) %>% unique()
fits <- list()
for (m in mouse_ids) {
f <- readRDS(paste0("../results/fits_", m, ".rds"))
fits[[m]] <- f
}
parameters <- dplyr::tibble()
for (m in mouse_ids) {
x <- fits[[m]]
if (!(is.null(x$metadata$breakpoints))) {
d <- x$breakpoints_fit$draws(c("changing_times[1]", "changing_times[2]"), format = "matrix") %>%
as_tibble()
d[,1:2] <- sapply(d[,1:2], as.numeric)
d <- d %>% mutate(mouse = m)
parameters <- bind_rows(parameters, d)
}
}
# Plot with inferred stuff
median_inferred_changepoints <- parameters %>%
group_by(mouse) %>%
summarise_all(median) %>%
summarise_all(median)
data_plot <- data %>%
dplyr::rename(count = TumourVolume) %>%
dplyr::mutate(time = time / 14) %>%
dplyr::filter(count > 0) %>%
dplyr::mutate(round_count = round(count)) %>%
dplyr::mutate(mouse = factor(mouse)) %>%
dplyr::filter(!((mouse == 541) & (time == 6))) %>%
dplyr::filter(!((mouse == 530) & (round_count == 1688)))
ggplot(data = data_plot, mapping = aes(x=time, y=count, color=Treatment_group., group=mouse, shape=mouse)) +
geom_point() +
geom_line() +
facet_grid(. ~ Treatment_group.) +
geom_vline(data = data_plot %>% filter(Treatment_group. != "Control"),
mapping = aes(xintercept = median_inferred_changepoints$`changing_times[1]`, col = "Median inferred changpoints")) +
geom_vline(data = data_plot %>% filter(Treatment_group. != "Control"),
mapping = aes(xintercept = median_inferred_changepoints$`changing_times[2]`, col = "Median inferred changpoints")) +
scale_color_manual(values = c(control_color, vline_color, treatment_color)) +
scale_fill_manual(values = c(vline_color)) +
scale_shape_manual(values = c(1:19)) +
labs(shape = "", color = "") +
biPOD:::my_ggplot_theme(cex_opt = CEX_OPT) +
theme(strip.background = element_blank(),
strip.text.y = element_blank(),
strip.text.x = element_blank()
)
ggplot(data = data_plot, mapping = aes(x=time, y=count, color=Treatment_group., group=mouse, shape=mouse)) +
geom_point() +
geom_line() +
facet_grid(. ~ Treatment_group.) +
geom_vline(data = data_plot %>% filter(Treatment_group. != "Control"),
mapping = aes(xintercept = median_inferred_changepoints$`changing_times[1]`, col = "Median inferred changpoints"),
linetype = "dashed") +
geom_vline(data = data_plot %>% filter(Treatment_group. != "Control"),
mapping = aes(xintercept = median_inferred_changepoints$`changing_times[2]`, col = "Median inferred changpoints")) +
scale_color_manual(values = c(control_color, vline_color, treatment_color)) +
scale_fill_manual(values = c(vline_color)) +
scale_shape_manual(values = c(1:19)) +
labs(shape = "", color = "") +
biPOD:::my_ggplot_theme(cex_opt = CEX_OPT) +
theme(strip.background = element_blank(),
strip.text.y = element_blank(),
strip.text.x = element_blank()
)
ggplot(data = data_plot, mapping = aes(x=time, y=count, color=Treatment_group., group=mouse, shape=mouse)) +
geom_point() +
geom_line() +
facet_grid(. ~ Treatment_group.) +
geom_vline(data = data_plot %>% filter(Treatment_group. != "Control"),
mapping = aes(xintercept = median_inferred_changepoints$`changing_times[1]`, col = "Median inferred changpoints"),
linetype = "dashed") +
geom_vline(data = data_plot %>% filter(Treatment_group. != "Control"),
mapping = aes(xintercept = median_inferred_changepoints$`changing_times[2]`, col = "Median inferred changpoints"),
linetype = "dashed") +
scale_color_manual(values = c(control_color, vline_color, treatment_color)) +
scale_fill_manual(values = c(vline_color)) +
scale_shape_manual(values = c(1:19)) +
labs(shape = "", color = "") +
biPOD:::my_ggplot_theme(cex_opt = CEX_OPT) +
theme(strip.background = element_blank(),
strip.text.y = element_blank(),
strip.text.x = element_blank()
)
plot_data <- ggplot(data = data_plot, mapping = aes(x=time, y=count, color=Treatment_group., group=mouse, shape=mouse)) +
geom_point() +
geom_line() +
facet_grid(. ~ Treatment_group.) +
geom_vline(data = data_plot %>% filter(Treatment_group. != "Control"),
mapping = aes(xintercept = median_inferred_changepoints$`changing_times[1]`, col = "Median inferred changpoints"),
linetype = "dashed") +
geom_vline(data = data_plot %>% filter(Treatment_group. != "Control"),
mapping = aes(xintercept = median_inferred_changepoints$`changing_times[2]`, col = "Median inferred changpoints"),
linetype = "dashed") +
scale_color_manual(values = c(control_color, vline_color, treatment_color)) +
scale_fill_manual(values = c(vline_color)) +
scale_shape_manual(values = c(1:19)) +
labs(shape = "", color = "") +
biPOD:::my_ggplot_theme(cex_opt = CEX_OPT) +
theme(strip.background = element_blank(),
strip.text.y = element_blank(),
strip.text.x = element_blank()
)
# Report_1
x <- fits[[532]]
report_1 <- biPOD::plot_report(x)$fits
setwd("~/Desktop/dottorato/biPOD")
