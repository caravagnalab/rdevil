dev.off()
saveRDS(object = results, file = "results/summary.rds")
View(results)
setwd("~/Desktop/dottorato/biPOD_project/paper/CRO")
rm(list=ls())
data = read_rds("data/data.rds")
meta_data = read_rds("data/meta_data.rds")
# Single Patient ####
id <- "RM291"
meta_data %>% dplyr::filter(codice == id)
data %>% dplyr::filter(codice == id)
setwd("~/Desktop/dottorato/biPOD_project/paper/CRO")
rm(list=ls())
require(tidyverse)
data = readRDS("data/data.rds")
meta_data = readRDS("data/meta_data.rds")
# Fit single patients ####
id <- meta_data$codice[2]
id <- "RMPTV291"
time_factor = 12
d <- data %>%
dplyr::filter(codice == id) %>%
dplyr::rename(count = value) %>%
dplyr::mutate(time = time / time_factor)
x <- biPOD::init(d, sample = id)
biPOD::plot_input(x)
setwd("~/Desktop/dottorato/biPOD_project/paper/CRO")
rm(list=ls())
require(ggplot2)
require(tidyverse)
require(patchwork)
data = read_rds("data/data.rds")
meta_data = read_rds("data/meta_data.rds")
# Filter patient with more than three obs
good_codes <- readRDS("results/good_codes.rds")
res <- readRDS("results/summary.rds") %>%
dplyr::filter(id %in% good_codes) %>%
dplyr::filter(t0 >= -80)
hist_rho <- res %>%
ggplot(mapping = aes(x = rho, fill = growth)) +
geom_histogram(alpha = .6, position = "identity") +
facet_wrap(~ growth) +
ggtitle("Growth rates")
hist_rho
hist_log_rho <- hist_rho + scale_x_continuous(trans = "log10") + ggtitle("Log 10 Growth rates")
hist_log_rho
hist_K <- res %>%
dplyr::filter(growth == "Logistic") %>%
ggplot(mapping = aes(x = K, fill = growth)) +
geom_histogram(alpha = .5) +
ggtitle("Carrying capacity")
hist_log_K <- hist_K + scale_x_continuous(trans = "log10") + ggtitle("Log 10 Carrying capcity")
bar_growth <- res %>%
ggplot(mapping = aes(x = growth, fill = growth, col = growth)) +
geom_bar(alpha = .7) +
ggtitle("Growth types")
hist_bf <- res %>%
ggplot(mapping = aes(x = log10(bf), fill = growth, col = growth)) +
geom_histogram(alpha = .7, position = "identity") +
ggtitle("Bayes factor")
hist_t0 <- res %>%
ggplot(mapping = aes(x = t0)) +
geom_histogram(alpha = .6, position = "identity", bins = 50) +
facet_wrap(~ growth, ncol = 1) +
ggtitle("Instant of birth")
hist_log_t0 <- res %>%
ggplot(mapping = aes(x = log10(-t0), fill = growth)) +
geom_histogram(alpha = .6, position = "identity") +
ggtitle("-Log10(Instant of birth)")
plot_rho <- (hist_rho | hist_log_rho) & theme(legend.position = "bottom")
plot_K <- (hist_K | hist_log_K)& theme(legend.position = "bottom")
plot_t0 <- (hist_t0 | hist_log_t0)& theme(legend.position = "bottom")
plot_types <- (bar_growth | hist_bf)& theme(legend.position = "bottom")
ggsave("img/rho.pdf", plot = plot_rho, dpi=400, width = 12, height = 8, units = 'in')
ggsave("img/K.pdf", plot = plot_K, dpi=400, width = 12, height = 8, units = 'in')
ggsave("img/t0.pdf", plot = plot_t0, dpi=400, width = 12, height = 8, units = 'in')
ggsave("img/types.pdf", plot = plot_types, dpi=400, width = 12, height = 8, units = 'in')
res %>%
ggplot(mapping = aes(x = rho_sd, y = t0_sd)) +
geom_point()
setwd("~/Desktop/dottorato/biPOD_project/paper/CRO")
rm(list=ls())
require(ggplot2)
require(tidyverse)
require(patchwork)
data = read_rds("data/data.rds")
meta_data = read_rds("data/meta_data.rds")
# Filter patient with more than three obs
good_codes <- readRDS("results/good_codes.rds")
id <- good_codes[1]
x <- readRDS(paste0("results/fits/", id, ".rds"))
biPOD::plot_report(x)
biPOD::plot_report(x)
id <- good_codes[2]
x <- readRDS(paste0("results/fits/", id, ".rds"))
biPOD::plot_report(x)
rep <- biPOD::plot_report(x)
rep$diagnostics
rep$fits
pdf("img/reports.pdf", width = 8, height = 11)
rep <- biPOD::plot_report(x)
rep$fits %>% print()
dev.off()
rep + ggtitle(if)
rep + ggtitle(id)
rep
rep$fits + ggtitle(id)
x$metadata$sample
rep$fits[[1]]
rep$fits[[1]] <- rep$fits[[1]] + ggtitle(id)
rep$fits
setwd("~/Desktop/dottorato/biPOD_project/paper/CRO")
rm(list=ls())
require(ggplot2)
require(tidyverse)
require(patchwork)
data = read_rds("data/data.rds")
meta_data = read_rds("data/meta_data.rds")
good_codes <- readRDS("results/good_codes.rds")
pdf("img/reports.pdf", width = 8, height = 11)
for (id in good_codes) {
x <- readRDS(paste0("results/fits/", id, ".rds"))
rep <- biPOD::plot_report(x)
rep$fits[[1]] <- rep$fits[[1]] + ggtitle(id)
rep$fits %>% print()
}
dev.off()
setwd("~/Desktop/dottorato/biPOD_project/paper/CRO")
rm(list=ls())
require(tidyverse)
data = readRDS("data/data.rds")
meta_data = readRDS("data/meta_data.rds")
# Fit single patients ####
id <- meta_data$codice[2]
id <- "RMPTV285"
time_factor = 12
d <- data %>%
dplyr::filter(codice == id) %>%
dplyr::rename(count = value) %>%
dplyr::mutate(time = time / time_factor)
x <- biPOD::init(d, sample = id)
biPOD::plot_input(x)
x <- biPOD::fit(x, infer_t0 = T, growth_type = "both")
x <- biPOD::fit(x, infer_t0 = F, growth_type = "both")
biPOD::plot_fit(x)
rho_draws <- biPOD:::get_parameter(x$fit, "rho[1]") %>% dplyr::pull(value)
median(rho_draws)
sd(rho_draws)
x$fit$draws
id <- "RMPTV288"
time_factor = 12
d <- data %>%
dplyr::filter(codice == id) %>%
dplyr::rename(count = value) %>%
dplyr::mutate(time = time / time_factor)
x <- biPOD::init(d, sample = id)
biPOD::plot_input(x)
x <- biPOD::fit(x, infer_t0 = F, growth_type = "both")
biPOD::plot_fit(x)
biPOD::plot_normalized_growth_rate_posteriors(x)
rho_draws <- biPOD:::get_parameter(x$fit, "rho[1]") %>% dplyr::pull(value)
median(rho_draws)
sd(rho_draws)
# Fit single patients ####
id <- meta_data$codice[2]
id <- "RMPTV212"
time_factor = 12
d <- data %>%
dplyr::filter(codice == id) %>%
dplyr::rename(count = value) %>%
dplyr::mutate(time = time / time_factor)
x <- biPOD::init(d, sample = id)
biPOD::plot_input(x)
x_no_t0 <- biPOD::fit(x, infer_t0 = F, growth_type = "both")
biPOD::plot_fit(x_no_t0)
biPOD::plot_normalized_growth_rate_posteriors(x)
biPOD::plot_normalized_growth_rate_posteriors(x_no_t0)
x_w_t0 <- biPOD::fit(x, infer_t0 = T, growth_type = "both")
biPOD::plot_fit(x_w_t0)
biPOD::plot_fit(x_no_t0)
biPOD::plot_fit(x_w_t0)
biPOD::plot_normalized_growth_rate_posteriors(x_no_t0)
biPOD::plot_normalized_growth_rate_posteriors(x_w_t0)
biPOD::plot_normalized_growth_rate_posteriors(x_no_t0)
biPOD::plot_normalized_growth_rate_posteriors(x_w_t0)
biPOD::plot_normalized_growth_rate_posteriors(x_no_t0)
biPOD::plot_normalized_growth_rate_posteriors(x_w_t0)
biPOD::plot_normalized_growth_rate_posteriors(x_no_t0)
biPOD::plot_normalized_growth_rate_posteriors(x_w_t0)
rho_draws_1 <- biPOD:::get_parameter(x_no_t0$fit, "rho[1]") %>% dplyr::pull(value)
rho_draws_2 <- biPOD:::get_parameter(x_w_t0$fit, "rho[1]") %>% dplyr::pull(value)
t.test(rho_draws_1, rho_draws_2)
rho_draws_1 %in% rho_draws_2
rho_draws_2
rho_draws_1
lim1 <- c(min(rho_draws_1), max(rho_draws_2))
lim1 <- c(min(rho_draws_1), max(rho_draws_1))
lim2 <- c(min(rho_draws_2), max(rho_draws_2))
rho_draws_1 > lim2[1]
(rho_draws_1 >= lim2[1]) & (rho_draws_1 <= lim2[1])
((rho_draws_1 >= lim2[1]) & (rho_draws_1 <= lim2[1])) %>% sum()
((rho_draws_1 >= lim2[1]) & (rho_draws_1 <= lim2[2])) %>% sum()
length(rho_draws_1)
(((rho_draws_1 >= lim2[1]) & (rho_draws_1 <= lim2[2])) %>% sum()) / length(rho_draws_1)
(((rho_draws_2 >= lim1[1]) & (rho_draws_2 <= lim1[2])) %>% sum()) / length(rho_draws_2)
biPOD::plot_normalized_growth_rate_posteriors(x_no_t0)
biPOD::plot_normalized_growth_rate_posteriors(x_w_t0)
rho_draws_1 <- biPOD:::get_parameter(x_no_t0$fit, "rho[1]") %>% dplyr::pull(value)
rho_draws_2 <- biPOD:::get_parameter(x_w_t0$fit, "rho[1]") %>% dplyr::pull(value)
hist(rho_draws_1)
dplyr::bind_rows(dplyr::tibble(name = "no_t0", value = rho_draws_1), dplyr::tibble(name = "with_t0", value = rho_draws_2))
dplyr::bind_rows(dplyr::tibble(name = "no_t0", value = rho_draws_1), dplyr::tibble(name = "with_t0", value = rho_draws_2)) %>%
ggplot(mapping = aes(x = value, fill = name)) +
geom_histogram()
dplyr::bind_rows(dplyr::tibble(name = "no_t0", value = rho_draws_1), dplyr::tibble(name = "with_t0", value = rho_draws_2)) %>%
ggplot(mapping = aes(x = value, fill = name)) +
geom_histogram(stat = "identity")
dplyr::bind_rows(dplyr::tibble(name = "no_t0", value = rho_draws_1), dplyr::tibble(name = "with_t0", value = rho_draws_2)) %>%
ggplot(mapping = aes(x = value, fill = name)) +
geom_histogram()
dplyr::bind_rows(dplyr::tibble(name = "no_t0", value = rho_draws_1), dplyr::tibble(name = "with_t0", value = rho_draws_2)) %>%
ggplot(mapping = aes(x = value, fill = name)) +
geom_histogram(alpha = .5)
dplyr::bind_rows(dplyr::tibble(name = "no_t0", value = rho_draws_1), dplyr::tibble(name = "with_t0", value = rho_draws_2)) %>%
ggplot(mapping = aes(x = value, fill = name)) +
geom_histogram(alpha = .7, position = "identity")
biPOD::plot_normalized_growth_rate_posteriors(x_no_t0)
biPOD::plot_normalized_growth_rate_posteriors(x_w_t0)
rho_draws_1 <- biPOD:::get_parameter(x_no_t0$fit, "rho[1]") %>% dplyr::pull(value)
rho_draws_2 <- biPOD:::get_parameter(x_w_t0$fit, "rho[1]") %>% dplyr::pull(value)
dplyr::bind_rows(dplyr::tibble(name = "no_t0", value = rho_draws_1), dplyr::tibble(name = "with_t0", value = rho_draws_2)) %>%
ggplot(mapping = aes(x = value, fill = name)) +
geom_histogram(alpha = .7, position = "identity")
lim1 <- c(min(rho_draws_1), max(rho_draws_1))
lim2 <- c(min(rho_draws_2), max(rho_draws_2))
lim1
lim2
lim1 <- c(stats::quantile(rho_draws_1, .05), stats::quantile(rho_draws_1, .95))
lim1
lim1 <- c(stats::quantile(rho_draws_1, .05), stats::quantile(rho_draws_1, .95))
lim2 <- c(stats::quantile(rho_draws_2, .05), stats::quantile(rho_draws_2, .95))
(((rho_draws_1 >= lim2[1]) & (rho_draws_1 <= lim2[2])) %>% sum()) / length(rho_draws_1)
(((rho_draws_2 >= lim1[1]) & (rho_draws_2 <= lim1[2])) %>% sum()) / length(rho_draws_2)
lim1
lim2
setwd("~/Desktop/dottorato/biPOD_project/paper/CRO")
rm(list=ls())
require(tidyverse)
data = readRDS("data/data.rds")
meta_data = readRDS("data/meta_data.rds")
# Fit single patients ####
id <- meta_data$codice[2]
id <- "RMPTV448"
time_factor = 12
d <- data %>%
dplyr::filter(codice == id) %>%
dplyr::rename(count = value) %>%
dplyr::mutate(time = time / time_factor)
x <- biPOD::init(d, sample = id)
biPOD::plot_input(x)
x_no_t0 <- biPOD::fit(x, infer_t0 = F, growth_type = "both")
x_w_t0 <- biPOD::fit(x, infer_t0 = T, growth_type = "both")
biPOD::plot_fit(x_no_t0)
biPOD::plot_fit(x_w_t0)
biPOD::plot_normalized_growth_rate_posteriors(x_no_t0)
biPOD::plot_normalized_growth_rate_posteriors(x_w_t0)
rho_draws_1 <- biPOD:::get_parameter(x_no_t0$fit, "rho[1]") %>% dplyr::pull(value)
rho_draws_2 <- biPOD:::get_parameter(x_w_t0$fit, "rho[1]") %>% dplyr::pull(value)
dplyr::bind_rows(dplyr::tibble(name = "no_t0", value = rho_draws_1), dplyr::tibble(name = "with_t0", value = rho_draws_2)) %>%
ggplot(mapping = aes(x = value, fill = name)) +
geom_histogram(alpha = .7, position = "identity")
meta_data = read_rds("data/meta_data.rds")
# Filter patient with more than three obs
good_codes <- readRDS("results/good_codes.rds")
res <- readRDS("results/summary.rds") %>%
dplyr::filter(id %in% good_codes) %>%
dplyr::filter(t0 >= -80)
data = read_rds("data/data.rds")
meta_data = read_rds("data/meta_data.rds")
# Filter patient with more than three obs
good_codes <- readRDS("results/good_codes.rds")
# Filter patient with more than three obs
good_codes <- readRDS("results/good_codes.rds")
res <- readRDS("results/summary.rds") %>%
dplyr::filter(id %in% good_codes)
res %>%
ggplot(mapping = aes(x = rho_sd, y = t0_sd)) +
geom_point()
res %>%
ggplot(mapping = aes(x = rho_sd, y = t0_sd)) +
res %>%
ggplot(mapping = aes(x = rho_sd, y = t0_sd)) +
# Compute statistics
res
# Compute statistics
res
# Compute statistics
stats::quantile(res$rho, probs = c(.05, .5, .95))
stats::quantile(ln(2) / res$rho, probs = c(.05, .5, .95))
stats::quantile(log(2) / res$rho, probs = c(.05, .5, .95))
res %>% group_by(growth) %>% summarise(n = n())
stats::quantile(log(2) / res$rho, probs = c(.05, .5, .95))
stats::quantile(res$t0, probs = c(.05, .5, .95))
res %>% dplyr::filter(t0 >= .80) %>% dplyr::pull(t0) %>% median()
res %>% dplyr::filter(t0 >= -80) %>% dplyr::pull(t0) %>% median()
res %>% dplyr::filter(growth == "Logistic")
res %>% dplyr::filter(growth == "Logistic") %>%
dplyr::pull(K)
res %>% dplyr::filter(growth == "Logistic") %>%
dplyr::pull(K) %>% hist()
res %>% dplyr::filter(growth == "Logistic") %>%
dplyr::pull(K) %>% stats::median()
setwd("~/Desktop/dottorato/biPOD_project/paper/CRO")
rm(list=ls())
require(ggplot2)
require(tidyverse)
require(patchwork)
data = read_rds("data/data.rds")
meta_data = read_rds("data/meta_data.rds")
meta_data
# Filter patient with more than three obs
good_codes <- readRDS("results/good_codes.rds")
res <- readRDS("results/summary.rds") %>%
dplyr::filter(id %in% good_codes)
hist_rho <- res %>%
ggplot(mapping = aes(x = rho, fill = growth)) +
geom_histogram(alpha = .6, position = "identity") +
facet_wrap(~ growth) +
ggtitle("Growth rates")
hist_log_rho <- hist_rho + scale_x_continuous(trans = "log10") + ggtitle("Log 10 Growth rates")
hist_K <- res %>%
dplyr::filter(growth == "Logistic") %>%
ggplot(mapping = aes(x = K, fill = growth)) +
geom_histogram(alpha = .5) +
ggtitle("Carrying capacity")
hist_log_K <- hist_K + scale_x_continuous(trans = "log10") + ggtitle("Log 10 Carrying capcity")
bar_growth <- res %>%
ggplot(mapping = aes(x = growth, fill = growth, col = growth)) +
geom_bar(alpha = .7) +
ggtitle("Growth types")
hist_bf <- res %>%
ggplot(mapping = aes(x = log10(bf), fill = growth, col = growth)) +
geom_histogram(alpha = .7, position = "identity") +
ggtitle("Bayes factor")
hist_t0 <- res %>%
ggplot(mapping = aes(x = t0)) +
geom_histogram(alpha = .6, position = "identity", bins = 50) +
facet_wrap(~ growth, ncol = 1) +
ggtitle("Instant of birth")
hist_log_t0 <- res %>%
ggplot(mapping = aes(x = log10(-t0), fill = growth)) +
geom_histogram(alpha = .6, position = "identity") +
ggtitle("-Log10(Instant of birth)")
plot_rho <- (hist_rho | hist_log_rho) & theme(legend.position = "bottom")
plot_K <- (hist_K | hist_log_K)& theme(legend.position = "bottom")
plot_t0 <- (hist_t0 | hist_log_t0)& theme(legend.position = "bottom")
plot_types <- (bar_growth | hist_bf)& theme(legend.position = "bottom")
ggsave("img/rho.pdf", plot = plot_rho, dpi=400, width = 12, height = 8, units = 'in')
ggsave("img/K.pdf", plot = plot_K, dpi=400, width = 12, height = 8, units = 'in')
ggsave("img/t0.pdf", plot = plot_t0, dpi=400, width = 12, height = 8, units = 'in')
ggsave("img/types.pdf", plot = plot_types, dpi=400, width = 12, height = 8, units = 'in')
# Test terapy vs rho ####
meta_data
# Test terapy vs rho ####
good_codes
meta_data$mese_inizio_terapia
is.na(meta_data$mese_inizio_terapia)
# Test terapy vs rho ####
meta_data$terapy = !(is.na(meta_data$mese_inizio_terapia))
meta_data$terapy
View(meta_data)
meta_data %>% dplyr::left_join(res, by = "codice")
meta_data
res
meta_data %>% dplyr::left_join(res, by = "id")
# Test terapy vs rho ####
meta_data$terapy = !(is.na(meta_data$mese_inizio_terapia))
meta_data$id = meta_data$codice
meta_data %>% dplyr::left_join(res, by = "id")
meta_data %>%
dplyr::left_join(res, by = "id") %>%
dplyr::filter(codice %in% good_codes)
meta_data %>%
dplyr::left_join(res, by = "id") %>%
dplyr::filter(codice %in% good_codes) %>%
ggplot(mapping = aes(x = log(2) / rho, fill = terapy)) +
geom_histogram(position = "identity", alpha = .6)
meta_data %>%
dplyr::left_join(res, by = "id") %>%
dplyr::filter(codice %in% good_codes) %>%
ggplot(mapping = aes(x = rho, fill = terapy)) +
geom_histogram(position = "identity", alpha = .6)
meta_data %>%
dplyr::left_join(res, by = "id") %>%
dplyr::filter(codice %in% good_codes) %>%
ggplot(mapping = aes(x = log(rho), fill = terapy)) +
geom_histogram(position = "identity", alpha = .6)
meta_data %>%
dplyr::left_join(res, by = "id")
meta_data %>%
dplyr::left_join(res, by = "id") %>%
dplyr::filter(codice %in% good_codes) %>%
dplyr::filter(t0 >= -80) %>%
ggplot(mapping = aes(x = log(2) / rho, fill = terapy)) +
geom_histogram(position = "identity", alpha = .6)
# Test terapy vs rho ####
meta_data$terapy = !(is.na(meta_data$mese_inizio_terapia))
meta_data$id = meta_data$codice
meta_data %>%
dplyr::left_join(res, by = "id") %>%
dplyr::filter(codice %in% good_codes) %>%
dplyr::filter(t0 >= -80) %>%
ggplot(mapping = aes(x = log(2) / rho, fill = terapy)) +
geom_histogram(position = "identity", alpha = .6)
meta_data %>%
dplyr::left_join(res, by = "id") %>%
dplyr::filter(codice %in% good_codes) %>%
ggplot(mapping = aes(x = log(rho), fill = terapy)) +
geom_histogram(position = "identity", alpha = .6)
meta_data %>%
dplyr::left_join(res, by = "id") %>%
dplyr::filter(codice %in% good_codes) %>%
ggplot(mapping = aes(x = growth, fill = terapy)) +
geom_histogram(position = "identity", alpha = .6)
meta_data %>%
dplyr::left_join(res, by = "id") %>%
dplyr::filter(codice %in% good_codes) %>%
ggplot(mapping = aes(x = growth, fill = terapy)) +
geom_histogram(position = "identity", alpha = .6, stat = "count")
meta_data %>%
dplyr::left_join(res, by = "id") %>%
dplyr::filter(codice %in% good_codes) %>%
ggplot(mapping = aes(x = growth, fill = terapy)) +
geom_histogram(alpha = .6, stat = "count")
meta_data %>%
dplyr::left_join(res, by = "id") %>%
dplyr::filter(codice %in% good_codes) %>%
dplyr::filter(t0 >= -80) %>%
ggplot(mapping = aes(x = log(2) / rho, fill = terapy)) +
geom_histogram(position = "identity", alpha = .6)
meta_data %>%
dplyr::left_join(res, by = "id") %>%
dplyr::filter(codice %in% good_codes) %>%
#dplyr::filter(t0 >= -80) %>%
ggplot(mapping = aes(x = log(2) / rho, fill = terapy)) +
geom_histogram(position = "identity", alpha = .6)
meta_data %>%
dplyr::left_join(res, by = "id") %>%
dplyr::filter(codice %in% good_codes) %>%
dplyr::filter(t0 >= -80) %>%
ggplot(mapping = aes(x = log(2) / rho, fill = terapy)) +
geom_histogram(position = "identity", alpha = .6)
meta_data %>%
dplyr::left_join(res, by = "id") %>%
dplyr::filter(codice %in% good_codes) %>%
dplyr::filter(t0 >= -80) %>%
ggplot(mapping = aes(x = log(2) / rho, fill = terapy)) +
geom_histogram(position = "identity", alpha = .6, bins = 50)
meta_data %>%
dplyr::left_join(res, by = "id") %>%
dplyr::filter(codice %in% good_codes) %>%
dplyr::filter(t0 >= -80) %>%
ggplot(mapping = aes(x = t0, fill = terapy)) +
geom_histogram(position = "identity", alpha = .6)
meta_data %>%
dplyr::left_join(res, by = "id") %>%
dplyr::filter(codice %in% good_codes) %>%
#dplyr::filter(t0 >= -80) %>%
ggplot(mapping = aes(x = t0, fill = terapy)) +
geom_histogram(position = "identity", alpha = .6)
meta_data %>%
dplyr::left_join(res, by = "id") %>%
dplyr::filter(codice %in% good_codes) %>%
#dplyr::filter(t0 >= -80) %>%
ggplot(mapping = aes(x = -log10(t0), fill = terapy)) +
geom_histogram(position = "identity", alpha = .6)
meta_data %>%
dplyr::left_join(res, by = "id") %>%
dplyr::filter(codice %in% good_codes) %>%
#dplyr::filter(t0 >= -80) %>%
ggplot(mapping = aes(x = log10(-t0), fill = terapy)) +
geom_histogram(position = "identity", alpha = .6)
meta_data %>%
dplyr::left_join(res, by = "id") %>%
dplyr::filter(codice %in% good_codes) %>%
dplyr::filter(t0 >= -80) %>%
ggplot(mapping = aes(x = log(2) / rho, fill = terapy)) +
geom_histogram(position = "identity", alpha = .6, bins = 50)
meta_data %>%
dplyr::left_join(res, by = "id") %>%
dplyr::filter(codice %in% good_codes) %>%
dplyr::filter(t0 >= -80) %>%
ggplot(mapping = aes(x = log(2) / rho, fill = terapy)) +
geom_histogram(position = "identity", alpha = .6, bins = 50) +
labs(x = "Doubling time", y = "Count") +
theme_bw()
meta_data %>%
dplyr::left_join(res, by = "id") %>%
dplyr::filter(codice %in% good_codes) %>%
dplyr::filter(t0 >= -80) %>%
ggplot(mapping = aes(x = log(2) / rho, fill = terapy)) +
geom_histogram(position = "identity", alpha = .6, bins = 50) +
labs(x = "Doubling time", y = "Count", fill = "Terapi") +
theme_bw()
meta_data %>%
dplyr::left_join(res, by = "id") %>%
dplyr::filter(codice %in% good_codes) %>%
dplyr::filter(t0 >= -80) %>%
ggplot(mapping = aes(x = log(2) / rho, fill = terapy)) +
geom_histogram(position = "identity", alpha = .6, bins = 50) +
labs(x = "Doubling time", y = "Count", fill = "Terapia") +
theme_bw()
